{% extends 'base.html' %}
{% block title %}Personas{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Personas</h2>
  <a href="{% url 'persona:persona_create' %}" class="btn btn-primary">Nueva Persona</a> 
  <a href="{% url 'persona:persona_importar' %}" class="btn btn-outline-secondary">Importar CSV</a>
 
  <a href="{% url 'oficina_list' %}" class="btn btn-secondary">Volver a Oficinas</a>
</div>

<form method="get" class="mb-3 d-flex" role="search">
  <input type="search" name="q" class="form-control me-2"
         placeholder="Buscar por apellido o nombre" value="{{ q }}">
  <button class="btn btn-outline-secondary" type="submit">Buscar</button>
</form>

<table class="table table-striped table-bordered align-middle">
  <thead>
    <tr>
      <th>Apellido</th>
      <th>Nombre</th>
      <th>Edad</th>
      <th>Oficina</th>
      <th style="width: 220px;">Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for p in page_obj %}
      <tr>
        <td>{{ p.apellido }}</td>
        <td>{{ p.nombre }}</td>
        <td>{{ p.edad }}</td>
        <td>{{ p.oficina.nombre }}</td>
        <td>
          
           <a href="{% url 'persona:persona_detail' p.pk %}" class="btn btn-sm btn-info">Ver</a>
           <a href="{% url 'persona:persona_update' p.pk %}" class="btn btn-sm btn-warning">Modificar</a>
           <a href="{% url 'persona:persona_delete' p.pk %}" class="btn btn-sm btn-danger">Eliminar</a>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="5" class="text-center">No hay personas.</td></tr>
    {% endfor %}
  </tbody>
</table>

<nav aria-label="Paginación">
  <ul class="pagination">
    {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&page={{ page_obj.previous_page_number }}">Anterior</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Anterior</span></li>
    {% endif %}

    <li class="page-item disabled">
      <span class="page-link">Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
    </li>

    {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&page={{ page_obj.next_page_number }}">Siguiente</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Siguiente</span></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
